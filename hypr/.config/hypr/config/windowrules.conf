######################################################################################
### HYPRLAND WINDOW RULES CONFIGURATION
### Reference: https://wiki.hyprland.org/Configuring/Window-Rules/
######################################################################################

### VARIABLES (REGEX PATTERNS) ###
# Common file/save/auth dialogs across various apps
$dialogs = match:title ^(Install from VSIX|Downloading Certificate|Open File|Save File|Save As|Open Folder|File Upload|Enter name of file to save to..|Authentication Required|Create or select new Steam library folder|About Zen Browser)(.*)$

# System utilities (Volume control, Bluetooth, Disk Utility, Calculator, Polkit agents)
$systemUtils = match:class ^(com.saivert.pwvucontrol|gtk-pipe-viewer|org.pulseaudio.pavucontrol|blueman-manager|org.gnome.DiskUtility|nm-connection-editor|gnome-calculator|org.gnome.Calculator|xdg-desktop-portal.*|polkit.*authentication-agent.*|zenity|pavucontrol)$

# Lightweight media players and viewers
$mediaViewers = match:title ^(imv|mpv|danmufloat|termfloat|nemo|ncmpcpp)$

# Picture-in-Picture patterns (Firefox/Chrome/Zen)
$pipWindows = match:title ^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$

# Steam-specific dialog windows
$steamDialogs = match:class ^(steam)$, match:title ^(Steam - Self Updater|Steam Settings|Create or select new Steam library folder)$

# Applications that should always float
$floatingApps = match:class ^(waypaper|io.missioncenter.MissionCenter|mpv)$

# Miscellaneous floating dialogs
$otherDialogs = match:title ^(OpenRGB|Network Connections|Do you want to retry your last request\??)

### WORKSPACE INITIALIZATION (Auto-start apps) ###
workspace = 1, on-created-empty:zen-browser
workspace = 2, on-created-empty:chromium
workspace = 3, on-created-empty:cursor
workspace = special:vesktop, on-created-empty:vesktop
workspace = special:telegram, on-created-empty:Telegram
workspace = special:slack, on-created-empty:slack
workspace = special:terminal, on-created-empty:$terminal

### WORKSPACE ASSIGNMENTS (Static Rules) ###
# Browsers
windowrule = workspace 1, match:class ^(zen-browser|zen)$
windowrule = workspace 2, match:class ^(chromium)$

# Development & Coding
windowrule = workspace 3, match:class ^([Cc]ode|code-url-handler|[Cc]ursor|cursor-url-handler|Cursor-url-handler)$

# Downloads / Torrenting
windowrule = workspace 5, match:class ^(qbittorrent)$

# Gaming
windowrule = workspace 6, match:class ^(steam_app_0|steam_app_1)$

# Email
windowrule = workspace 7, match:class ^(thunderbird)$

# Communication (Scratchpads/Special Workspaces)
windowrule = workspace special:telegram, match:class ^(org.telegram.desktop|Telegram|telegram-desktop)$
windowrule = workspace special:vesktop, match:class ^(vesktop)$
windowrule = workspace special:slack, match:class ^(Slack|slack-desktop)$

### FLOATING GEOMETRY RULES ###

# System Utilities (Standardized Size)
windowrule = float on, match:class org.kde.kdeconnect.handler
windowrule = float on, $systemUtils
windowrule = size 60%, $systemUtils

# Floating Applications
windowrule = float on, $floatingApps
windowrule = size 60%, $floatingApps

# General Dialogs
windowrule = float on, $dialogs
windowrule = size 45%, $dialogs
windowrule = float on, $otherDialogs

# Specific App Fixes
windowrule = float on, match:class ^(org.gnome.Nautilus)$, match:title ^(Select File containing CA certificate.*)$
windowrule = float on, match:class ^blender$, match:initial_title ^Blender$
windowrule = size 15%, match:class ^(gnome-calculator|org.gnome.Calculator)$

# Global Update Prompt
windowrule = float on, match:title .*Global Updates.*
windowrule = center on, match:title .*Global Updates.*
windowrule = size 1600 900, match:title .*Global Updates.*

# Steam Library Picker
windowrule = float on, $steamDialogs
windowrule = size 1600 900, match:title ^(Create or select new Steam library folder)$

# Picture-in-Picture Logic
windowrule = float on, $pipWindows
windowrule = pin on, $pipWindows
windowrule = keep_aspect_ratio on, $pipWindows
windowrule = size 960 540, $pipWindows
windowrule = move 25%-, $pipWindows

# Media Viewers
windowrule = float on, $mediaViewers
windowrule = size 60%, $mediaViewers
windowrule = pin on, match:title ^(danmufloat)$

### VISUAL & BEHAVIOR RULES ###
# Shadow and Blur Policies
windowrule = no_shadow on, match:float no
windowrule = no_blur on, match:xwayland 1

# Event Suppression
windowrule = suppress_event maximize, match:class .*

### GAMING & FULLSCREEN RULES ###
windowrule = idle_inhibit fullscreen, match:title .*
windowrule = immediate on, match:fullscreen yes
windowrule = no_blur on, match:fullscreen yes
windowrule = no_anim on, match:fullscreen yes

### LAYER RULES (Bar, Wallpaper, Notification Effects) ###
# Animations
layerrule = animation slide down, match:namespace waybar
layerrule = animation fade, match:namespace wallpaper

# Blur & Transparency (Regex Grouped)
layerrule = blur on, match:namespace (wofi|notifications|eww|eww1|eww2|eww3|rofi|logout_dialog|gtk-layer-shell|nwg-dock)
layerrule = ignore_alpha 0, match:namespace (wofi|notifications|eww|eww1|eww2|eww3|rofi|gtk-layer-shell|nwg-dock)

# Z-Index Ordering
layerrule = order 1, match:namespace eww1
layerrule = order 2, match:namespace eww2
layerrule = order 3, match:namespace (eww3|rofi)